\doxysection{src/main.cpp File Reference}
\hypertarget{main_8cpp}{}\label{main_8cpp}\index{src/main.cpp@{src/main.cpp}}


Main entry point for the CO2 Meter application.  


{\ttfamily \#include $<$Wire.\+h$>$}\newline
{\ttfamily \#include $<$Adafruit\+\_\+\+GFX.\+h$>$}\newline
{\ttfamily \#include $<$Adafruit\+\_\+\+SSD1306.\+h$>$}\newline
{\ttfamily \#include $<$Adafruit\+\_\+\+BMP280.\+h$>$}\newline
{\ttfamily \#include $<$Spark\+Fun\+\_\+\+SCD30\+\_\+\+Arduino\+\_\+\+Library.\+h$>$}\newline
{\ttfamily \#include $<$EEPROM.\+h$>$}\newline
{\ttfamily \#include "{}config.\+h"{}}\newline
{\ttfamily \#include "{}Display\+Manager.\+h"{}}\newline
{\ttfamily \#include "{}Sensor\+Manager.\+h"{}}\newline
{\ttfamily \#include "{}Logger.\+h"{}}\newline
{\ttfamily \#include $<$Arduino.\+h$>$}\newline
{\ttfamily \#include "{}I2\+CScanner.\+h"{}}\newline
Include dependency graph for main.\+cpp\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{main_8cpp__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{main_8cpp_afe461d27b9c48d5921c00d521181f12f}{loop}} ()
\begin{DoxyCompactList}\small\item\em Main loop for retrieving sensor data and updating the display. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{main_8cpp_a4fc01d736fe50cf5b977f755b675f11d}{setup}} ()
\begin{DoxyCompactList}\small\item\em Initializes the system, including the display, sensors, and logger. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_display_manager}{Display\+Manager}} \mbox{\hyperlink{main_8cpp_a136eaecbaec3846cfa8fab715e6b1649}{display\+Manager}}
\begin{DoxyCompactList}\small\item\em Instance of the \doxylink{class_display_manager}{Display\+Manager} class for managing the OLED display. \end{DoxyCompactList}\item 
\mbox{\hyperlink{class_i2_c_scanner}{I2\+CScanner}} \mbox{\hyperlink{main_8cpp_a830ba2e1cf78bb96f3a948021b8efaaa}{i2c\+Scanner}}
\begin{DoxyCompactList}\small\item\em Instance of the \doxylink{class_i2_c_scanner}{I2\+CScanner} class for scanning the I2C bus. \end{DoxyCompactList}\item 
\mbox{\hyperlink{class_sensor_manager}{Sensor\+Manager}} \mbox{\hyperlink{main_8cpp_a9996dbd27067a1f5b043af338b3e3cbe}{sensor\+Manager}}
\begin{DoxyCompactList}\small\item\em Instance of the \doxylink{class_sensor_manager}{Sensor\+Manager} class for managing the SCD30 and BMP280 sensors. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Main entry point for the CO2 Meter application. 

This file initializes the system, including the display, sensors, and logger. It continuously retrieves sensor data, logs it, and displays warnings or normal readings based on CO2 levels. 

Definition in file \mbox{\hyperlink{main_8cpp_source}{main.\+cpp}}.



\doxysubsection{Function Documentation}
\Hypertarget{main_8cpp_a4fc01d736fe50cf5b977f755b675f11d}\index{main.cpp@{main.cpp}!setup@{setup}}
\index{setup@{setup}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{setup()}{setup()}}
{\footnotesize\ttfamily \label{main_8cpp_a4fc01d736fe50cf5b977f755b675f11d} 
void setup (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



Initializes the system, including the display, sensors, and logger. 

This function sets up the serial communication, initializes the display and sensors, and performs a calibration check for the SCD30 sensor. If any initialization fails, the system halts. 

Definition at line \mbox{\hyperlink{main_8cpp_source_l00045}{45}} of file \mbox{\hyperlink{main_8cpp_source}{main.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00046\ \ \ \ \ Serial.begin(115200);}
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{keywordflow}{while}\ (!Serial);}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \ \ \ \ \mbox{\hyperlink{class_logger_ac862952b8ffa9de295a496af0108785c}{Logger::error}}(\textcolor{stringliteral}{"{}This\ is\ test\ error\ message."{}});\ \ \ \ \textcolor{comment}{//\ Should\ always\ print}}
\DoxyCodeLine{00050\ \ \ \ \ \mbox{\hyperlink{class_logger_a4d229b17ee039e273686455c74382ec6}{Logger::warning}}(\textcolor{stringliteral}{"{}This\ test\ a\ warning\ message."{}});\ \textcolor{comment}{//\ Should\ not\ print\ if\ LOG\_LEVEL=LOG\_ERROR}}
\DoxyCodeLine{00051\ \ \ \ \ \mbox{\hyperlink{class_logger_a0c5851d03ba2e560bfd57aeb713267b3}{Logger::info}}(\textcolor{stringliteral}{"{}This\ is\ test\ info\ message."{}});\ \ \ \ \ \ \textcolor{comment}{//\ Should\ not\ print\ if\ LOG\_LEVEL=LOG\_ERROR}}
\DoxyCodeLine{00052\ \ \ \ \ \mbox{\hyperlink{class_logger_abeffd58a6beace1b1c01a5324227fd83}{Logger::debug}}(\textcolor{stringliteral}{"{}This\ is\ test\ debug\ message."{}});\ \ \ \ \textcolor{comment}{//\ Should\ not\ print\ if\ LOG\_LEVEL=LOG\_ERROR}}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \ \ \mbox{\hyperlink{class_logger_a0c5851d03ba2e560bfd57aeb713267b3}{Logger::info}}(\textcolor{stringliteral}{"{}Initializing..."{}});}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \textcolor{preprocessor}{\#if\ RUN\_I2C\_SCANNER\ ==\ TRUE }}
\DoxyCodeLine{00057\ \ \ \ \ \mbox{\hyperlink{main_8cpp_a830ba2e1cf78bb96f3a948021b8efaaa}{i2cScanner}}.scan();}
\DoxyCodeLine{00058\ \textcolor{preprocessor}{\#endif }}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{comment}{//\ Initialize\ the\ display}}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{main_8cpp_a136eaecbaec3846cfa8fab715e6b1649}{displayManager}}.initialize())\ \{}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_logger_ac862952b8ffa9de295a496af0108785c}{Logger::error}}(\textcolor{stringliteral}{"{}Display\ initialization\ failed!"{}});}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;;);\ \textcolor{comment}{//\ Halt\ if\ display\ initialization\ fails}}
\DoxyCodeLine{00064\ \ \ \ \ \}}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \textcolor{preprocessor}{\#if\ RUN\_DISPLAY\_CHECK\ ==\ TRUE }}
\DoxyCodeLine{00067\ \ \ \ \ \mbox{\hyperlink{main_8cpp_a136eaecbaec3846cfa8fab715e6b1649}{displayManager}}.runDisplayCheck();}
\DoxyCodeLine{00068\ \textcolor{preprocessor}{\#endif }}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \ \ \ \ \mbox{\hyperlink{main_8cpp_a136eaecbaec3846cfa8fab715e6b1649}{displayManager}}.splashScreen(\textcolor{stringliteral}{"{}Initializing..."{}});}
\DoxyCodeLine{00071\ \ \ \ \ delay(2000);}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{comment}{//\ Initialize\ sensors}}
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{main_8cpp_a9996dbd27067a1f5b043af338b3e3cbe}{sensorManager}}.initializeSensors())\ \{}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{main_8cpp_a136eaecbaec3846cfa8fab715e6b1649}{displayManager}}.splashScreen(\textcolor{stringliteral}{"{}Sensor\ init\ failed!"{}});}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_logger_a0c5851d03ba2e560bfd57aeb713267b3}{Logger::info}}(\textcolor{stringliteral}{"{}Sensor\ init\ failed!"{}});}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;;);\ \textcolor{comment}{//\ Halt\ if\ sensor\ initialization\ fails}}
\DoxyCodeLine{00078\ \ \ \ \ \}}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{comment}{//\ Check\ and\ calibrate\ the\ SCD30\ sensor}}
\DoxyCodeLine{00081\ \ \ \ \ \mbox{\hyperlink{main_8cpp_a9996dbd27067a1f5b043af338b3e3cbe}{sensorManager}}.checkAndCalibrateSCD30();}
\DoxyCodeLine{00082\ \ \ \ \ \mbox{\hyperlink{class_logger_a0c5851d03ba2e560bfd57aeb713267b3}{Logger::info}}(\textcolor{stringliteral}{"{}Initialization\ complete."{}});}
\DoxyCodeLine{00083\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=341pt]{main_8cpp_a4fc01d736fe50cf5b977f755b675f11d_cgraph}
\end{center}
\end{figure}
\Hypertarget{main_8cpp_afe461d27b9c48d5921c00d521181f12f}\index{main.cpp@{main.cpp}!loop@{loop}}
\index{loop@{loop}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{loop()}{loop()}}
{\footnotesize\ttfamily \label{main_8cpp_afe461d27b9c48d5921c00d521181f12f} 
void loop (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



Main loop for retrieving sensor data and updating the display. 

This function continuously retrieves sensor data, logs the readings, and updates the display. It displays warnings if CO2 levels exceed predefined thresholds or normal readings otherwise. 

Definition at line \mbox{\hyperlink{main_8cpp_source_l00091}{91}} of file \mbox{\hyperlink{main_8cpp_source}{main.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00092\ \ \ \ \ \mbox{\hyperlink{class_logger_abeffd58a6beace1b1c01a5324227fd83}{Logger::debug}}(\textcolor{stringliteral}{"{}Entering\ loop..."{}});}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{main_8cpp_a9996dbd27067a1f5b043af338b3e3cbe}{sensorManager}}.isDataAvailable())\ \{}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_logger_abeffd58a6beace1b1c01a5324227fd83}{Logger::debug}}(\textcolor{stringliteral}{"{}Sensor\ data\ is\ available."{}});}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Retrieve\ sensor\ readings}}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ co2\ =\ \mbox{\hyperlink{main_8cpp_a9996dbd27067a1f5b043af338b3e3cbe}{sensorManager}}.getCO2();}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ temperatureSCD\ =\ \mbox{\hyperlink{main_8cpp_a9996dbd27067a1f5b043af338b3e3cbe}{sensorManager}}.getTemperatureSCD();}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ humidity\ =\ \mbox{\hyperlink{main_8cpp_a9996dbd27067a1f5b043af338b3e3cbe}{sensorManager}}.getHumidity();}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ temperatureBMP\ =\ \mbox{\hyperlink{main_8cpp_a9996dbd27067a1f5b043af338b3e3cbe}{sensorManager}}.getTemperatureBMP();}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ pressure\ =\ \mbox{\hyperlink{main_8cpp_a9996dbd27067a1f5b043af338b3e3cbe}{sensorManager}}.getPressure();}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_logger_abeffd58a6beace1b1c01a5324227fd83}{Logger::debug}}(\textcolor{stringliteral}{"{}Sensor\ readings\ retrieved."{}});}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_logger_a0c5851d03ba2e560bfd57aeb713267b3}{Logger::info}}((\textcolor{stringliteral}{"{}CO2:\ "{}}\ +\ String(co2)\ +\ \textcolor{stringliteral}{"{}\ ppm"{}}).c\_str());}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_logger_a0c5851d03ba2e560bfd57aeb713267b3}{Logger::info}}((\textcolor{stringliteral}{"{}Temperature\ (SCD30):\ "{}}\ +\ String(temperatureSCD)\ +\ \textcolor{stringliteral}{"{}\ °C"{}}).c\_str());}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_logger_a0c5851d03ba2e560bfd57aeb713267b3}{Logger::info}}((\textcolor{stringliteral}{"{}Temperature\ (BMP280):\ "{}}\ +\ String(temperatureBMP)\ +\ \textcolor{stringliteral}{"{}\ °C"{}}).c\_str());}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_logger_a0c5851d03ba2e560bfd57aeb713267b3}{Logger::info}}((\textcolor{stringliteral}{"{}Humidity:\ "{}}\ +\ String(humidity)\ +\ \textcolor{stringliteral}{"{}\ \%"{}}).c\_str());}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_logger_a0c5851d03ba2e560bfd57aeb713267b3}{Logger::info}}((\textcolor{stringliteral}{"{}Pressure:\ "{}}\ +\ String(pressure)\ +\ \textcolor{stringliteral}{"{}\ hPa"{}}).c\_str());}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Display\ warnings\ or\ normal\ readings\ based\ on\ CO2\ levels}}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (co2\ >\ CO2\_CRITICAL\_THRESHOLD)\ \{}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_logger_a4d229b17ee039e273686455c74382ec6}{Logger::warning}}(\textcolor{stringliteral}{"{}CRITICAL:\ High\ CO2\ levels!"{}});}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{main_8cpp_a136eaecbaec3846cfa8fab715e6b1649}{displayManager}}.showBlinkingWarning(}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}CRITICAL:"{}},\ \textcolor{stringliteral}{"{}High\ CO2"{}},\ \textcolor{stringliteral}{"{}levels!"{}},\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ co2,\ temperatureSCD,\ temperatureBMP,\ humidity,\ pressure);}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (co2\ >\ CO2\_MODERATE\_THRESHOLD)\ \{}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_logger_a4d229b17ee039e273686455c74382ec6}{Logger::warning}}(\textcolor{stringliteral}{"{}MODERATE:\ Elevated\ CO2\ levels!"{}});}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{main_8cpp_a136eaecbaec3846cfa8fab715e6b1649}{displayManager}}.showBlinkingWarning(}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}MODERATE:"{}},\ \textcolor{stringliteral}{"{}Elevated\ CO2"{}},\ \textcolor{stringliteral}{"{}levels!"{}},\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ co2,\ temperatureSCD,\ temperatureBMP,\ humidity,\ pressure);}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_logger_a0c5851d03ba2e560bfd57aeb713267b3}{Logger::info}}(\textcolor{stringliteral}{"{}Displaying\ normal\ readings."{}});}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{main_8cpp_a136eaecbaec3846cfa8fab715e6b1649}{displayManager}}.showNormalScreen(co2,\ temperatureSCD,\ temperatureBMP,\ humidity,\ pressure);}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00126\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_logger_abeffd58a6beace1b1c01a5324227fd83}{Logger::debug}}(\textcolor{stringliteral}{"{}Sensor\ data\ not\ available."{}});}
\DoxyCodeLine{00128\ \ \ \ \ \}}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \ \ \ \ delay(1000);\ \textcolor{comment}{//\ Short\ delay\ for\ smoother\ blinking}}
\DoxyCodeLine{00131\ \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=335pt]{main_8cpp_afe461d27b9c48d5921c00d521181f12f_cgraph}
\end{center}
\end{figure}


\doxysubsection{Variable Documentation}
\Hypertarget{main_8cpp_a136eaecbaec3846cfa8fab715e6b1649}\index{main.cpp@{main.cpp}!displayManager@{displayManager}}
\index{displayManager@{displayManager}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{displayManager}{displayManager}}
{\footnotesize\ttfamily \label{main_8cpp_a136eaecbaec3846cfa8fab715e6b1649} 
\mbox{\hyperlink{class_display_manager}{Display\+Manager}} display\+Manager}



Instance of the \doxylink{class_display_manager}{Display\+Manager} class for managing the OLED display. 



Definition at line \mbox{\hyperlink{main_8cpp_source_l00026}{26}} of file \mbox{\hyperlink{main_8cpp_source}{main.\+cpp}}.

\Hypertarget{main_8cpp_a9996dbd27067a1f5b043af338b3e3cbe}\index{main.cpp@{main.cpp}!sensorManager@{sensorManager}}
\index{sensorManager@{sensorManager}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{sensorManager}{sensorManager}}
{\footnotesize\ttfamily \label{main_8cpp_a9996dbd27067a1f5b043af338b3e3cbe} 
\mbox{\hyperlink{class_sensor_manager}{Sensor\+Manager}} sensor\+Manager}



Instance of the \doxylink{class_sensor_manager}{Sensor\+Manager} class for managing the SCD30 and BMP280 sensors. 



Definition at line \mbox{\hyperlink{main_8cpp_source_l00031}{31}} of file \mbox{\hyperlink{main_8cpp_source}{main.\+cpp}}.

\Hypertarget{main_8cpp_a830ba2e1cf78bb96f3a948021b8efaaa}\index{main.cpp@{main.cpp}!i2cScanner@{i2cScanner}}
\index{i2cScanner@{i2cScanner}!main.cpp@{main.cpp}}
\doxysubsubsection{\texorpdfstring{i2cScanner}{i2cScanner}}
{\footnotesize\ttfamily \label{main_8cpp_a830ba2e1cf78bb96f3a948021b8efaaa} 
\mbox{\hyperlink{class_i2_c_scanner}{I2\+CScanner}} i2c\+Scanner}



Instance of the \doxylink{class_i2_c_scanner}{I2\+CScanner} class for scanning the I2C bus. 



Definition at line \mbox{\hyperlink{main_8cpp_source_l00036}{36}} of file \mbox{\hyperlink{main_8cpp_source}{main.\+cpp}}.

